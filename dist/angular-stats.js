!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("angular")):"function"==typeof define&&define.amd?define(["angular"],e):"object"==typeof exports?exports.AngularStats=e(require("angular")):t.AngularStats=e(t.angular)}(self,(t=>(()=>{"use strict";var e={526:e=>{e.exports=t}},o={};function n(t){var i=o[t];if(void 0!==i)return i.exports;var s=o[t]={exports:{}};return e[t](s,s.exports,n),s.exports}n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};return(()=>{n.r(i),n.d(i,{AngularStats:()=>o,angularStats:()=>s});var t=n(526);function e(t,e,o){var n;return(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e))?n:String(n))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class o{constructor(t,o,n,i,s){e(this,"rootScope",void 0),e(this,"document",void 0),e(this,"window",void 0),e(this,"timeout",void 0),e(this,"logger",void 0),e(this,"scopesList",void 0),e(this,"watchersList",void 0),e(this,"componentsInfo",void 0),e(this,"domElementsCount",void 0),e(this,"nodeNameList",void 0),e(this,"startingElement",void 0),e(this,"digestInfo",{duration:"0"}),this.rootScope=t,this.document=o,this.window=n,this.timeout=i,this.logger=s,this.startingElement=this.document.find("app")}setStartingElement(t){this.startingElement=t}analyzeWebApp(){if(this.scopesList=[],this.watchersList=[],this.componentsInfo={},this.domElementsCount=0,this.nodeNameList={},!this.startingElement||0===this.startingElement.length)throw Error(this.startingElement+" is not a valid selector");return this.analizeScope(this.rootScope),this.detectFromElement(this.startingElement),this.calculateDigestDuration(),this.composeMessage()}composeMessage(){try{let t="GENERAL\n";t+="----------------------\n",t+="Tot scopes: "+this.scopesList.length+"\n",t+="Tot watchers: "+this.watchersList.length+"\n",t+="Tot DOM Elements: "+this.domElementsCount+"\n",t+="Digest duration: "+this.digestInfo.duration+" ms \n\n",t+="\nCOMPONENTS\n",t+="----------------------\n";for(const e in this.componentsInfo)t+="- "+e+"\ns: "+this.componentsInfo[e].scopesCount+", w: "+this.componentsInfo[e].watchers.length+"\n";t+="\n\nHTMLElement\n",t+="----------------------\n";for(const e in this.nodeNameList)t+=e+": "+this.nodeNameList[e]+"\n";return t}catch(t){return this.logger.error(t),"Error"}}analizeScope(e){try{if(-1===this.scopesList.indexOf(e)){this.scopesList.push(e);const o=e.$ctrl?e.$ctrl.name:e.name?e.name:"Unknown";void 0===this.componentsInfo[o]?this.componentsInfo[o]={name:o,scopesCount:1,watchers:[]}:this.componentsInfo[o].scopesCount++,t.forEach(e.$$watchers,(t=>{-1===this.watchersList.indexOf(t)&&this.watchersList.push(t),-1===this.componentsInfo[o].watchers.indexOf(t)&&this.componentsInfo[o].watchers.push(t)})),e.$$childHead&&this.analizeScope(e.$$childHead),e.$$childTail&&this.analizeScope(e.$$childTail),e.$$prevSibling&&this.analizeScope(e.$$prevSibling),e.$$nextSibling&&this.analizeScope(e.$$nextSibling)}}catch(t){this.logger.error(t)}}detectFromElement(e){try{this.domElementsCount++,t.element(e).scope()&&this.analizeScope(t.element(e).scope()),t.forEach(t.element(e).children(),(e=>{void 0===this.nodeNameList[e.nodeName]?this.nodeNameList[e.nodeName]=1:this.nodeNameList[e.nodeName]++,this.detectFromElement(t.element(e))}))}catch(t){this.logger.error(t)}}calculateDigestDuration(){var t=this;try{let e=0;const o=Object.getPrototypeOf(this.rootScope),n=o.$digest;o.$digest=function(){const o=t.getTime();for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];n.apply(t.rootScope,s),e=t.getTime()-o,t.digestInfo.duration=e.toFixed(2)}}catch(t){this.logger.error(t)}}getTime(){return performance?performance.now():this.getDate().getTime()}getDate(){return new Date}}e(o,"$inject",["$rootScope","$document","$window","$timeout","$log"]);const s=t.module("angular-stats",[]).service("AngularStats",o).name})(),i})()));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0MsQ0FBQyxhQUFjLFlBQWEsVUFBVyxXQUFZLFNDTnRFLE1BQU00RCxFQUFldkIsRUFBQUEsT0FBZSxnQkFBaUIsSUFDekR3QixRQUFRLGVBQWdCN0QsR0FDeEI0QixJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQW5ndWxhclN0YXRzL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9Bbmd1bGFyU3RhdHMvZXh0ZXJuYWwgdW1kIFwiYW5ndWxhclwiIiwid2VicGFjazovL0FuZ3VsYXJTdGF0cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9Bbmd1bGFyU3RhdHMvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL0FuZ3VsYXJTdGF0cy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0FuZ3VsYXJTdGF0cy93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL0FuZ3VsYXJTdGF0cy8uL3NyYy9hbmd1bGFyLXN0YXRzL2FuZ3VsYXItc3RhdHMuc2VydmljZS50cyIsIndlYnBhY2s6Ly9Bbmd1bGFyU3RhdHMvLi9zcmMvYW5ndWxhci1zdGF0cy9hbmd1bGFyLXN0YXRzLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJhbmd1bGFyXCIpKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtcImFuZ3VsYXJcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiQW5ndWxhclN0YXRzXCJdID0gZmFjdG9yeShyZXF1aXJlKFwiYW5ndWxhclwiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wiQW5ndWxhclN0YXRzXCJdID0gZmFjdG9yeShyb290W1wiYW5ndWxhclwiXSk7XG59KShzZWxmLCAoX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fNTI2X18pID0+IHtcbnJldHVybiAiLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzUyNl9fOyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0ICogYXMgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcblxuZXhwb3J0IGludGVyZmFjZSBJQW5ndWxhclN0YXRzIHtcbiAgc2V0U3RhcnRpbmdFbGVtZW50KGVsZW1lbnQ6IEpRTGl0ZSk6IHZvaWQ7XG5cbiAgYW5hbHl6ZVdlYkFwcCgpOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBBbmd1bGFyU3RhdHMgaW1wbGVtZW50cyBJQW5ndWxhclN0YXRzIHtcbiAgcHVibGljIHN0YXRpYyAkaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyRkb2N1bWVudCcsICckd2luZG93JywgJyR0aW1lb3V0JywgJyRsb2cnXTtcblxuICBwcml2YXRlIHNjb3Blc0xpc3QhOiBuZy5JU2NvcGVbXTtcbiAgcHJpdmF0ZSB3YXRjaGVyc0xpc3QhOiBhbnlbXTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIHByaXZhdGUgY29tcG9uZW50c0luZm8hOiB7IFtrZXk6IHN0cmluZ106IGFueSB9OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICBwcml2YXRlIGRvbUVsZW1lbnRzQ291bnQhOiBudW1iZXI7XG4gIHByaXZhdGUgbm9kZU5hbWVMaXN0ITogeyBba2V5OiBzdHJpbmddOiBhbnkgfTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgcHJpdmF0ZSBzdGFydGluZ0VsZW1lbnQ6IEpRTGl0ZTtcbiAgcHJpdmF0ZSBkaWdlc3RJbmZvID0geyBkdXJhdGlvbjogJzAnIH07XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByb290U2NvcGU6IG5nLklSb290U2NvcGVTZXJ2aWNlLFxuICAgICAgICAgICAgICBwcml2YXRlIGRvY3VtZW50OiBuZy5JRG9jdW1lbnRTZXJ2aWNlLFxuICAgICAgICAgICAgICBwcml2YXRlIHdpbmRvdzogbmcuSVdpbmRvd1NlcnZpY2UsXG4gICAgICAgICAgICAgIHByaXZhdGUgdGltZW91dDogbmcuSVRpbWVvdXRTZXJ2aWNlLFxuICAgICAgICAgICAgICBwcml2YXRlIGxvZ2dlcjogbmcuSUxvZ1NlcnZpY2UpIHtcbiAgICB0aGlzLnN0YXJ0aW5nRWxlbWVudCA9IHRoaXMuZG9jdW1lbnQuZmluZCgnYXBwJyk7XG4gIH1cblxuICBwdWJsaWMgc2V0U3RhcnRpbmdFbGVtZW50KGVsZW1lbnQ6IEpRTGl0ZSk6IHZvaWQge1xuICAgIHRoaXMuc3RhcnRpbmdFbGVtZW50ID0gZWxlbWVudDtcbiAgfVxuXG4gIHB1YmxpYyBhbmFseXplV2ViQXBwKCk6IHN0cmluZyB7XG4gICAgdGhpcy5zY29wZXNMaXN0ID0gW107XG4gICAgdGhpcy53YXRjaGVyc0xpc3QgPSBbXTtcbiAgICB0aGlzLmNvbXBvbmVudHNJbmZvID0ge307XG5cbiAgICB0aGlzLmRvbUVsZW1lbnRzQ291bnQgPSAwO1xuICAgIHRoaXMubm9kZU5hbWVMaXN0ID0ge307XG5cbiAgICBpZiAoIXRoaXMuc3RhcnRpbmdFbGVtZW50IHx8IHRoaXMuc3RhcnRpbmdFbGVtZW50Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgRXJyb3IodGhpcy5zdGFydGluZ0VsZW1lbnQgKyAnIGlzIG5vdCBhIHZhbGlkIHNlbGVjdG9yJyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5hbmFsaXplU2NvcGUodGhpcy5yb290U2NvcGUpO1xuICAgICAgdGhpcy5kZXRlY3RGcm9tRWxlbWVudCh0aGlzLnN0YXJ0aW5nRWxlbWVudCk7XG4gICAgICB0aGlzLmNhbGN1bGF0ZURpZ2VzdER1cmF0aW9uKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY29tcG9zZU1lc3NhZ2UoKTtcbiAgfVxuXG4gIHByaXZhdGUgY29tcG9zZU1lc3NhZ2UoKTogc3RyaW5nIHtcbiAgICB0cnkge1xuICAgICAgbGV0IG1leCA9ICdHRU5FUkFMXFxuJztcbiAgICAgIG1leCArPSAnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcbic7XG4gICAgICBtZXggKz0gJ1RvdCBzY29wZXM6ICcgKyB0aGlzLnNjb3Blc0xpc3QubGVuZ3RoICsgJ1xcbic7XG4gICAgICBtZXggKz0gJ1RvdCB3YXRjaGVyczogJyArIHRoaXMud2F0Y2hlcnNMaXN0Lmxlbmd0aCArICdcXG4nO1xuICAgICAgbWV4ICs9ICdUb3QgRE9NIEVsZW1lbnRzOiAnICsgdGhpcy5kb21FbGVtZW50c0NvdW50ICsgJ1xcbic7XG4gICAgICBtZXggKz0gJ0RpZ2VzdCBkdXJhdGlvbjogJyArIHRoaXMuZGlnZXN0SW5mby5kdXJhdGlvbiArICcgbXMgXFxuXFxuJztcblxuICAgICAgbWV4ICs9ICdcXG5DT01QT05FTlRTXFxuJztcbiAgICAgIG1leCArPSAnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcbic7XG4gICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gdGhpcy5jb21wb25lbnRzSW5mbykge1xuICAgICAgICBtZXggKz0gJy0gJyArIG5hbWUgKyAnXFxuJyArICdzOiAnICsgdGhpcy5jb21wb25lbnRzSW5mb1tuYW1lXS5zY29wZXNDb3VudCArICcsIHc6ICcgKyB0aGlzLmNvbXBvbmVudHNJbmZvW25hbWVdLndhdGNoZXJzLmxlbmd0aCArICdcXG4nO1xuICAgICAgfVxuXG4gICAgICBtZXggKz0gJ1xcblxcbkhUTUxFbGVtZW50XFxuJztcbiAgICAgIG1leCArPSAnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcbic7XG4gICAgICBmb3IgKGNvbnN0IG5vZGVOYW1lIGluIHRoaXMubm9kZU5hbWVMaXN0KSB7XG4gICAgICAgIG1leCArPSBub2RlTmFtZSArICc6ICcgKyB0aGlzLm5vZGVOYW1lTGlzdFtub2RlTmFtZV0gKyAnXFxuJztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG1leDtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGUpO1xuICAgICAgcmV0dXJuICdFcnJvcic7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhbmFsaXplU2NvcGUoY3VycmVudFNjb3BlOiBhbnkpOiB2b2lkIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgdHJ5IHtcbiAgICAgIGlmICh0aGlzLnNjb3Blc0xpc3QuaW5kZXhPZihjdXJyZW50U2NvcGUpID09PSAtMSkge1xuICAgICAgICB0aGlzLnNjb3Blc0xpc3QucHVzaChjdXJyZW50U2NvcGUpO1xuXG4gICAgICAgIGNvbnN0IG5hbWUgPSBjdXJyZW50U2NvcGVbJyRjdHJsJ10gPyBjdXJyZW50U2NvcGVbJyRjdHJsJ11bJ25hbWUnXSA6IChjdXJyZW50U2NvcGVbJ25hbWUnXSA/IGN1cnJlbnRTY29wZVsnbmFtZSddIDogJ1Vua25vd24nKTtcbiAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50c0luZm9bbmFtZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRoaXMuY29tcG9uZW50c0luZm9bbmFtZV0gPSB7XG4gICAgICAgICAgICBuYW1lLCBzY29wZXNDb3VudDogMSwgd2F0Y2hlcnM6IFtdLFxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5jb21wb25lbnRzSW5mb1tuYW1lXS5zY29wZXNDb3VudCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGN1cnJlbnRTY29wZVsnJCR3YXRjaGVycyddLCAod2F0Y2hlcikgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLndhdGNoZXJzTGlzdC5pbmRleE9mKHdhdGNoZXIpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy53YXRjaGVyc0xpc3QucHVzaCh3YXRjaGVyKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy5jb21wb25lbnRzSW5mb1tuYW1lXS53YXRjaGVycy5pbmRleE9mKHdhdGNoZXIpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRzSW5mb1tuYW1lXS53YXRjaGVycy5wdXNoKHdhdGNoZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRTY29wZVsnJCRjaGlsZEhlYWQnXSkge1xuICAgICAgICAgIHRoaXMuYW5hbGl6ZVNjb3BlKGN1cnJlbnRTY29wZVsnJCRjaGlsZEhlYWQnXSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY3VycmVudFNjb3BlWyckJGNoaWxkVGFpbCddKSB7XG4gICAgICAgICAgdGhpcy5hbmFsaXplU2NvcGUoY3VycmVudFNjb3BlWyckJGNoaWxkVGFpbCddKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjdXJyZW50U2NvcGVbJyQkcHJldlNpYmxpbmcnXSkge1xuICAgICAgICAgIHRoaXMuYW5hbGl6ZVNjb3BlKGN1cnJlbnRTY29wZVsnJCRwcmV2U2libGluZyddKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjdXJyZW50U2NvcGVbJyQkbmV4dFNpYmxpbmcnXSkge1xuICAgICAgICAgIHRoaXMuYW5hbGl6ZVNjb3BlKGN1cnJlbnRTY29wZVsnJCRuZXh0U2libGluZyddKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkZXRlY3RGcm9tRWxlbWVudChlbGVtZW50OiBKUUxpdGUpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5kb21FbGVtZW50c0NvdW50Kys7XG4gICAgICBpZiAoYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpLnNjb3BlKCkpIHtcbiAgICAgICAgdGhpcy5hbmFsaXplU2NvcGUoYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpLnNjb3BlKCkpO1xuICAgICAgfVxuXG4gICAgICBhbmd1bGFyLmZvckVhY2goYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpLmNoaWxkcmVuKCksIChjaGlsZEVsZW1lbnQ6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgICAgIGlmICh0aGlzLm5vZGVOYW1lTGlzdFtjaGlsZEVsZW1lbnQubm9kZU5hbWVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB0aGlzLm5vZGVOYW1lTGlzdFtjaGlsZEVsZW1lbnQubm9kZU5hbWVdID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm5vZGVOYW1lTGlzdFtjaGlsZEVsZW1lbnQubm9kZU5hbWVdKys7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kZXRlY3RGcm9tRWxlbWVudChhbmd1bGFyLmVsZW1lbnQoY2hpbGRFbGVtZW50KSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGUpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlRGlnZXN0RHVyYXRpb24oKTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBkdXJhdGlvbiA9IDA7XG4gICAgICBjb25zdCBzY29wZVByb3RvdHlwZSA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzLnJvb3RTY29wZSk7XG4gICAgICBjb25zdCBhbmd1bGFyRGlnZXN0ID0gc2NvcGVQcm90b3R5cGUuJGRpZ2VzdDtcblxuICAgICAgc2NvcGVQcm90b3R5cGUuJGRpZ2VzdCA9ICguLi5hcmdzOiBhbnlbXSkgPT4geyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLmdldFRpbWUoKTtcbiAgICAgICAgYW5ndWxhckRpZ2VzdC5hcHBseSh0aGlzLnJvb3RTY29wZSwgYXJncyk7XG4gICAgICAgIGR1cmF0aW9uID0gdGhpcy5nZXRUaW1lKCkgLSBzdGFydDtcbiAgICAgICAgdGhpcy5kaWdlc3RJbmZvLmR1cmF0aW9uID0gZHVyYXRpb24udG9GaXhlZCgyKTtcbiAgICAgIH07XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihlKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFRpbWUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcGVyZm9ybWFuY2UgPyBwZXJmb3JtYW5jZS5ub3coKSA6IHRoaXMuZ2V0RGF0ZSgpLmdldFRpbWUoKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RGF0ZSgpOiBEYXRlIHtcbiAgICByZXR1cm4gbmV3IERhdGUoKTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IEFuZ3VsYXJTdGF0cyB9IGZyb20gJy4vYW5ndWxhci1zdGF0cy5zZXJ2aWNlJztcblxuZXhwb3J0IGNvbnN0IGFuZ3VsYXJTdGF0cyA9IGFuZ3VsYXIubW9kdWxlKCdhbmd1bGFyLXN0YXRzJywgW10pXG4gIC5zZXJ2aWNlKCdBbmd1bGFyU3RhdHMnLCBBbmd1bGFyU3RhdHMpXG4gIC5uYW1lO1xuIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsInJlcXVpcmUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fNTI2X18iLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiQW5ndWxhclN0YXRzIiwiY29uc3RydWN0b3IiLCJyb290U2NvcGUiLCJkb2N1bWVudCIsIndpbmRvdyIsInRpbWVvdXQiLCJsb2dnZXIiLCJfZGVmaW5lUHJvcGVydHkiLCJkdXJhdGlvbiIsInRoaXMiLCJzdGFydGluZ0VsZW1lbnQiLCJmaW5kIiwic2V0U3RhcnRpbmdFbGVtZW50IiwiZWxlbWVudCIsImFuYWx5emVXZWJBcHAiLCJzY29wZXNMaXN0Iiwid2F0Y2hlcnNMaXN0IiwiY29tcG9uZW50c0luZm8iLCJkb21FbGVtZW50c0NvdW50Iiwibm9kZU5hbWVMaXN0IiwibGVuZ3RoIiwiRXJyb3IiLCJhbmFsaXplU2NvcGUiLCJkZXRlY3RGcm9tRWxlbWVudCIsImNhbGN1bGF0ZURpZ2VzdER1cmF0aW9uIiwiY29tcG9zZU1lc3NhZ2UiLCJtZXgiLCJkaWdlc3RJbmZvIiwibmFtZSIsInNjb3Blc0NvdW50Iiwid2F0Y2hlcnMiLCJub2RlTmFtZSIsImUiLCJlcnJvciIsImN1cnJlbnRTY29wZSIsImluZGV4T2YiLCJwdXNoIiwiYW5ndWxhciIsIndhdGNoZXIiLCJzY29wZSIsImNoaWxkcmVuIiwiY2hpbGRFbGVtZW50IiwiX3RoaXMiLCJzY29wZVByb3RvdHlwZSIsImdldFByb3RvdHlwZU9mIiwiYW5ndWxhckRpZ2VzdCIsIiRkaWdlc3QiLCJzdGFydCIsImdldFRpbWUiLCJfbGVuIiwiYXJndW1lbnRzIiwiYXJncyIsIkFycmF5IiwiX2tleSIsImFwcGx5IiwidG9GaXhlZCIsInBlcmZvcm1hbmNlIiwibm93IiwiZ2V0RGF0ZSIsIkRhdGUiLCJhbmd1bGFyU3RhdHMiLCJzZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==
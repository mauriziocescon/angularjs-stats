!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("angular")):"function"==typeof define&&define.amd?define(["angular"],e):"object"==typeof exports?exports.AngularStats=e(require("angular")):t.AngularStats=e(t.angular)}(self,(t=>(()=>{"use strict";var e={874:e=>{e.exports=t}},n={};function o(t){var s=n[t];if(void 0!==s)return s.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,o),i.exports}o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{AngularStats:()=>e,angularStats:()=>n});var t=o(874);class e{rootScope;document;window;timeout;logger;static $inject=["$rootScope","$document","$window","$timeout","$log"];scopesList;watchersList;componentsInfo;domElementsCount;nodeNameList;startingElement;digestInfo={duration:"0"};constructor(t,e,n,o,s){this.rootScope=t,this.document=e,this.window=n,this.timeout=o,this.logger=s,this.startingElement=this.document.find("app")}setStartingElement(t){this.startingElement=t}analyzeWebApp(){if(this.scopesList=[],this.watchersList=[],this.componentsInfo={},this.domElementsCount=0,this.nodeNameList={},!this.startingElement||0===this.startingElement.length)throw Error(this.startingElement+" is not a valid selector");return this.analizeScope(this.rootScope),this.detectFromElement(this.startingElement),this.calculateDigestDuration(),this.composeMessage()}composeMessage(){try{let t="GENERAL\n";t+="----------------------\n",t+="Tot scopes: "+this.scopesList.length+"\n",t+="Tot watchers: "+this.watchersList.length+"\n",t+="Tot DOM Elements: "+this.domElementsCount+"\n",t+="Digest duration: "+this.digestInfo.duration+" ms \n\n",t+="\nCOMPONENTS\n",t+="----------------------\n";for(const e in this.componentsInfo)t+="- "+e+"\ns: "+this.componentsInfo[e].scopesCount+", w: "+this.componentsInfo[e].watchers.length+"\n";t+="\n\nHTMLElement\n",t+="----------------------\n";for(const e in this.nodeNameList)t+=e+": "+this.nodeNameList[e]+"\n";return t}catch(t){return this.logger.error(t),"Error"}}analizeScope(e){try{if(-1===this.scopesList.indexOf(e)){this.scopesList.push(e);const n=e.$ctrl?e.$ctrl.name:e.name?e.name:"Unknown";void 0===this.componentsInfo[n]?this.componentsInfo[n]={name:n,scopesCount:1,watchers:[]}:this.componentsInfo[n].scopesCount++,t.forEach(e.$$watchers,(t=>{-1===this.watchersList.indexOf(t)&&this.watchersList.push(t),-1===this.componentsInfo[n].watchers.indexOf(t)&&this.componentsInfo[n].watchers.push(t)})),e.$$childHead&&this.analizeScope(e.$$childHead),e.$$childTail&&this.analizeScope(e.$$childTail),e.$$prevSibling&&this.analizeScope(e.$$prevSibling),e.$$nextSibling&&this.analizeScope(e.$$nextSibling)}}catch(t){this.logger.error(t)}}detectFromElement(e){try{this.domElementsCount++,t.element(e).scope()&&this.analizeScope(t.element(e).scope()),t.forEach(t.element(e).children(),(e=>{void 0===this.nodeNameList[e.nodeName]?this.nodeNameList[e.nodeName]=1:this.nodeNameList[e.nodeName]++,this.detectFromElement(t.element(e))}))}catch(t){this.logger.error(t)}}calculateDigestDuration(){var t=this;try{let e=0;const n=Object.getPrototypeOf(this.rootScope),o=n.$digest;n.$digest=function(){const n=t.getTime();for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];o.apply(t.rootScope,i),e=t.getTime()-n,t.digestInfo.duration=e.toFixed(2)}}catch(t){this.logger.error(t)}}getTime(){return performance?performance.now():this.getDate().getTime()}getDate(){return new Date}}const n=t.module("angular-stats",[]).service("AngularStats",e).name})(),s})()));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Ly9Bbmd1bGFyU3RhdHMvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL0FuZ3VsYXJTdGF0cy9leHRlcm5hbCB1bWQgXCJhbmd1bGFyXCIiLCJ3ZWJwYWNrOi8vQW5ndWxhclN0YXRzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0FuZ3VsYXJTdGF0cy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQW5ndWxhclN0YXRzL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vQW5ndWxhclN0YXRzL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vQW5ndWxhclN0YXRzLy4vc3JjL2FuZ3VsYXItc3RhdHMvYW5ndWxhci1zdGF0cy5zZXJ2aWNlLnRzIiwid2VicGFjazovL0FuZ3VsYXJTdGF0cy8uL3NyYy9hbmd1bGFyLXN0YXRzL2FuZ3VsYXItc3RhdHMubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcImFuZ3VsYXJcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW1wiYW5ndWxhclwiXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJBbmd1bGFyU3RhdHNcIl0gPSBmYWN0b3J5KHJlcXVpcmUoXCJhbmd1bGFyXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJBbmd1bGFyU3RhdHNcIl0gPSBmYWN0b3J5KHJvb3RbXCJhbmd1bGFyXCJdKTtcbn0pKHNlbGYsIChfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX184NzRfXykgPT4ge1xucmV0dXJuICIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fODc0X187IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJpbXBvcnQgKiBhcyBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIElBbmd1bGFyU3RhdHMge1xuICBzZXRTdGFydGluZ0VsZW1lbnQoZWxlbWVudDogSlFMaXRlKTogdm9pZDtcblxuICBhbmFseXplV2ViQXBwKCk6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEFuZ3VsYXJTdGF0cyBpbXBsZW1lbnRzIElBbmd1bGFyU3RhdHMge1xuICBwdWJsaWMgc3RhdGljICRpbmplY3QgPSBbJyRyb290U2NvcGUnLCAnJGRvY3VtZW50JywgJyR3aW5kb3cnLCAnJHRpbWVvdXQnLCAnJGxvZyddO1xuXG4gIHByaXZhdGUgc2NvcGVzTGlzdCE6IG5nLklTY29wZVtdO1xuICBwcml2YXRlIHdhdGNoZXJzTGlzdCE6IGFueVtdOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgcHJpdmF0ZSBjb21wb25lbnRzSW5mbyE6IHsgW2tleTogc3RyaW5nXTogYW55IH07IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXG4gIHByaXZhdGUgZG9tRWxlbWVudHNDb3VudCE6IG51bWJlcjtcbiAgcHJpdmF0ZSBub2RlTmFtZUxpc3QhOiB7IFtrZXk6IHN0cmluZ106IGFueSB9OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblxuICBwcml2YXRlIHN0YXJ0aW5nRWxlbWVudDogSlFMaXRlO1xuICBwcml2YXRlIGRpZ2VzdEluZm8gPSB7IGR1cmF0aW9uOiAnMCcgfTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJvb3RTY29wZTogbmcuSVJvb3RTY29wZVNlcnZpY2UsXG4gICAgICAgICAgICAgIHByaXZhdGUgZG9jdW1lbnQ6IG5nLklEb2N1bWVudFNlcnZpY2UsXG4gICAgICAgICAgICAgIHByaXZhdGUgd2luZG93OiBuZy5JV2luZG93U2VydmljZSxcbiAgICAgICAgICAgICAgcHJpdmF0ZSB0aW1lb3V0OiBuZy5JVGltZW91dFNlcnZpY2UsXG4gICAgICAgICAgICAgIHByaXZhdGUgbG9nZ2VyOiBuZy5JTG9nU2VydmljZSkge1xuICAgIHRoaXMuc3RhcnRpbmdFbGVtZW50ID0gdGhpcy5kb2N1bWVudC5maW5kKCdhcHAnKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRTdGFydGluZ0VsZW1lbnQoZWxlbWVudDogSlFMaXRlKTogdm9pZCB7XG4gICAgdGhpcy5zdGFydGluZ0VsZW1lbnQgPSBlbGVtZW50O1xuICB9XG5cbiAgcHVibGljIGFuYWx5emVXZWJBcHAoKTogc3RyaW5nIHtcbiAgICB0aGlzLnNjb3Blc0xpc3QgPSBbXTtcbiAgICB0aGlzLndhdGNoZXJzTGlzdCA9IFtdO1xuICAgIHRoaXMuY29tcG9uZW50c0luZm8gPSB7fTtcblxuICAgIHRoaXMuZG9tRWxlbWVudHNDb3VudCA9IDA7XG4gICAgdGhpcy5ub2RlTmFtZUxpc3QgPSB7fTtcblxuICAgIGlmICghdGhpcy5zdGFydGluZ0VsZW1lbnQgfHwgdGhpcy5zdGFydGluZ0VsZW1lbnQubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBFcnJvcih0aGlzLnN0YXJ0aW5nRWxlbWVudCArICcgaXMgbm90IGEgdmFsaWQgc2VsZWN0b3InKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLmFuYWxpemVTY29wZSh0aGlzLnJvb3RTY29wZSk7XG4gICAgICB0aGlzLmRldGVjdEZyb21FbGVtZW50KHRoaXMuc3RhcnRpbmdFbGVtZW50KTtcbiAgICAgIHRoaXMuY2FsY3VsYXRlRGlnZXN0RHVyYXRpb24oKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jb21wb3NlTWVzc2FnZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBjb21wb3NlTWVzc2FnZSgpOiBzdHJpbmcge1xuICAgIHRyeSB7XG4gICAgICBsZXQgbWV4ID0gJ0dFTkVSQUxcXG4nO1xuICAgICAgbWV4ICs9ICctLS0tLS0tLS0tLS0tLS0tLS0tLS0tXFxuJztcbiAgICAgIG1leCArPSAnVG90IHNjb3BlczogJyArIHRoaXMuc2NvcGVzTGlzdC5sZW5ndGggKyAnXFxuJztcbiAgICAgIG1leCArPSAnVG90IHdhdGNoZXJzOiAnICsgdGhpcy53YXRjaGVyc0xpc3QubGVuZ3RoICsgJ1xcbic7XG4gICAgICBtZXggKz0gJ1RvdCBET00gRWxlbWVudHM6ICcgKyB0aGlzLmRvbUVsZW1lbnRzQ291bnQgKyAnXFxuJztcbiAgICAgIG1leCArPSAnRGlnZXN0IGR1cmF0aW9uOiAnICsgdGhpcy5kaWdlc3RJbmZvLmR1cmF0aW9uICsgJyBtcyBcXG5cXG4nO1xuXG4gICAgICBtZXggKz0gJ1xcbkNPTVBPTkVOVFNcXG4nO1xuICAgICAgbWV4ICs9ICctLS0tLS0tLS0tLS0tLS0tLS0tLS0tXFxuJztcbiAgICAgIGZvciAoY29uc3QgbmFtZSBpbiB0aGlzLmNvbXBvbmVudHNJbmZvKSB7XG4gICAgICAgIG1leCArPSAnLSAnICsgbmFtZSArICdcXG4nICsgJ3M6ICcgKyB0aGlzLmNvbXBvbmVudHNJbmZvW25hbWVdLnNjb3Blc0NvdW50ICsgJywgdzogJyArIHRoaXMuY29tcG9uZW50c0luZm9bbmFtZV0ud2F0Y2hlcnMubGVuZ3RoICsgJ1xcbic7XG4gICAgICB9XG5cbiAgICAgIG1leCArPSAnXFxuXFxuSFRNTEVsZW1lbnRcXG4nO1xuICAgICAgbWV4ICs9ICctLS0tLS0tLS0tLS0tLS0tLS0tLS0tXFxuJztcbiAgICAgIGZvciAoY29uc3Qgbm9kZU5hbWUgaW4gdGhpcy5ub2RlTmFtZUxpc3QpIHtcbiAgICAgICAgbWV4ICs9IG5vZGVOYW1lICsgJzogJyArIHRoaXMubm9kZU5hbWVMaXN0W25vZGVOYW1lXSArICdcXG4nO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbWV4O1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZSk7XG4gICAgICByZXR1cm4gJ0Vycm9yJztcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFuYWxpemVTY29wZShjdXJyZW50U2NvcGU6IGFueSk6IHZvaWQgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICB0cnkge1xuICAgICAgaWYgKHRoaXMuc2NvcGVzTGlzdC5pbmRleE9mKGN1cnJlbnRTY29wZSkgPT09IC0xKSB7XG4gICAgICAgIHRoaXMuc2NvcGVzTGlzdC5wdXNoKGN1cnJlbnRTY29wZSk7XG5cbiAgICAgICAgY29uc3QgbmFtZSA9IGN1cnJlbnRTY29wZVsnJGN0cmwnXSA/IGN1cnJlbnRTY29wZVsnJGN0cmwnXVsnbmFtZSddIDogKGN1cnJlbnRTY29wZVsnbmFtZSddID8gY3VycmVudFNjb3BlWyduYW1lJ10gOiAnVW5rbm93bicpO1xuICAgICAgICBpZiAodGhpcy5jb21wb25lbnRzSW5mb1tuYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdGhpcy5jb21wb25lbnRzSW5mb1tuYW1lXSA9IHtcbiAgICAgICAgICAgIG5hbWUsIHNjb3Blc0NvdW50OiAxLCB3YXRjaGVyczogW10sXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmNvbXBvbmVudHNJbmZvW25hbWVdLnNjb3Blc0NvdW50Kys7XG4gICAgICAgIH1cblxuICAgICAgICBhbmd1bGFyLmZvckVhY2goY3VycmVudFNjb3BlWyckJHdhdGNoZXJzJ10sICh3YXRjaGVyKSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMud2F0Y2hlcnNMaXN0LmluZGV4T2Yod2F0Y2hlcikgPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLndhdGNoZXJzTGlzdC5wdXNoKHdhdGNoZXIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLmNvbXBvbmVudHNJbmZvW25hbWVdLndhdGNoZXJzLmluZGV4T2Yod2F0Y2hlcikgPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudHNJbmZvW25hbWVdLndhdGNoZXJzLnB1c2god2F0Y2hlcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoY3VycmVudFNjb3BlWyckJGNoaWxkSGVhZCddKSB7XG4gICAgICAgICAgdGhpcy5hbmFsaXplU2NvcGUoY3VycmVudFNjb3BlWyckJGNoaWxkSGVhZCddKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjdXJyZW50U2NvcGVbJyQkY2hpbGRUYWlsJ10pIHtcbiAgICAgICAgICB0aGlzLmFuYWxpemVTY29wZShjdXJyZW50U2NvcGVbJyQkY2hpbGRUYWlsJ10pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGN1cnJlbnRTY29wZVsnJCRwcmV2U2libGluZyddKSB7XG4gICAgICAgICAgdGhpcy5hbmFsaXplU2NvcGUoY3VycmVudFNjb3BlWyckJHByZXZTaWJsaW5nJ10pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGN1cnJlbnRTY29wZVsnJCRuZXh0U2libGluZyddKSB7XG4gICAgICAgICAgdGhpcy5hbmFsaXplU2NvcGUoY3VycmVudFNjb3BlWyckJG5leHRTaWJsaW5nJ10pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihlKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRldGVjdEZyb21FbGVtZW50KGVsZW1lbnQ6IEpRTGl0ZSk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmRvbUVsZW1lbnRzQ291bnQrKztcbiAgICAgIGlmIChhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCkuc2NvcGUoKSkge1xuICAgICAgICB0aGlzLmFuYWxpemVTY29wZShhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCkuc2NvcGUoKSk7XG4gICAgICB9XG5cbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCkuY2hpbGRyZW4oKSwgKGNoaWxkRWxlbWVudDogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgICAgaWYgKHRoaXMubm9kZU5hbWVMaXN0W2NoaWxkRWxlbWVudC5ub2RlTmFtZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRoaXMubm9kZU5hbWVMaXN0W2NoaWxkRWxlbWVudC5ub2RlTmFtZV0gPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubm9kZU5hbWVMaXN0W2NoaWxkRWxlbWVudC5ub2RlTmFtZV0rKztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRldGVjdEZyb21FbGVtZW50KGFuZ3VsYXIuZWxlbWVudChjaGlsZEVsZW1lbnQpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVEaWdlc3REdXJhdGlvbigpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgbGV0IGR1cmF0aW9uID0gMDtcbiAgICAgIGNvbnN0IHNjb3BlUHJvdG90eXBlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMucm9vdFNjb3BlKTtcbiAgICAgIGNvbnN0IGFuZ3VsYXJEaWdlc3QgPSBzY29wZVByb3RvdHlwZS4kZGlnZXN0O1xuXG4gICAgICBzY29wZVByb3RvdHlwZS4kZGlnZXN0ID0gKC4uLmFyZ3M6IGFueVtdKSA9PiB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBjb25zdCBzdGFydCA9IHRoaXMuZ2V0VGltZSgpO1xuICAgICAgICBhbmd1bGFyRGlnZXN0LmFwcGx5KHRoaXMucm9vdFNjb3BlLCBhcmdzKTtcbiAgICAgICAgZHVyYXRpb24gPSB0aGlzLmdldFRpbWUoKSAtIHN0YXJ0O1xuICAgICAgICB0aGlzLmRpZ2VzdEluZm8uZHVyYXRpb24gPSBkdXJhdGlvbi50b0ZpeGVkKDIpO1xuICAgICAgfTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGUpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGltZSgpOiBudW1iZXIge1xuICAgIHJldHVybiBwZXJmb3JtYW5jZSA/IHBlcmZvcm1hbmNlLm5vdygpIDogdGhpcy5nZXREYXRlKCkuZ2V0VGltZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXREYXRlKCk6IERhdGUge1xuICAgIHJldHVybiBuZXcgRGF0ZSgpO1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBhbmd1bGFyIGZyb20gJ2FuZ3VsYXInO1xuaW1wb3J0IHsgQW5ndWxhclN0YXRzIH0gZnJvbSAnLi9hbmd1bGFyLXN0YXRzLnNlcnZpY2UnO1xuXG5leHBvcnQgY29uc3QgYW5ndWxhclN0YXRzID0gYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXItc3RhdHMnLCBbXSlcbiAgLnNlcnZpY2UoJ0FuZ3VsYXJTdGF0cycsIEFuZ3VsYXJTdGF0cylcbiAgLm5hbWU7XG4iXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwicmVxdWlyZSIsImRlZmluZSIsImFtZCIsInNlbGYiLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX184NzRfXyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJBbmd1bGFyU3RhdHMiLCJyb290U2NvcGUiLCJkb2N1bWVudCIsIndpbmRvdyIsInRpbWVvdXQiLCJsb2dnZXIiLCJzdGF0aWMiLCJzY29wZXNMaXN0Iiwid2F0Y2hlcnNMaXN0IiwiY29tcG9uZW50c0luZm8iLCJkb21FbGVtZW50c0NvdW50Iiwibm9kZU5hbWVMaXN0Iiwic3RhcnRpbmdFbGVtZW50IiwiZGlnZXN0SW5mbyIsImR1cmF0aW9uIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiZmluZCIsInNldFN0YXJ0aW5nRWxlbWVudCIsImVsZW1lbnQiLCJhbmFseXplV2ViQXBwIiwibGVuZ3RoIiwiRXJyb3IiLCJhbmFsaXplU2NvcGUiLCJkZXRlY3RGcm9tRWxlbWVudCIsImNhbGN1bGF0ZURpZ2VzdER1cmF0aW9uIiwiY29tcG9zZU1lc3NhZ2UiLCJtZXgiLCJuYW1lIiwic2NvcGVzQ291bnQiLCJ3YXRjaGVycyIsIm5vZGVOYW1lIiwiZSIsImVycm9yIiwiY3VycmVudFNjb3BlIiwiaW5kZXhPZiIsInB1c2giLCJhbmd1bGFyIiwid2F0Y2hlciIsInNjb3BlIiwiY2hpbGRyZW4iLCJjaGlsZEVsZW1lbnQiLCJfdGhpcyIsInNjb3BlUHJvdG90eXBlIiwiZ2V0UHJvdG90eXBlT2YiLCJhbmd1bGFyRGlnZXN0IiwiJGRpZ2VzdCIsInN0YXJ0IiwiZ2V0VGltZSIsIl9sZW4iLCJhcmd1bWVudHMiLCJhcmdzIiwiQXJyYXkiLCJfa2V5IiwiYXBwbHkiLCJ0b0ZpeGVkIiwicGVyZm9ybWFuY2UiLCJub3ciLCJnZXREYXRlIiwiRGF0ZSIsImFuZ3VsYXJTdGF0cyIsInNlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9